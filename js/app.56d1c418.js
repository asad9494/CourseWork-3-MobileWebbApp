(function(){"use strict";var e={3515:function(e,t,o){var r=o(5130),s=o(6768),a=o(4232);const n={class:"navbar navbar-expand-lg navbar-light bg-white border-bottom"},l={class:"container"},i=["textContent"],c=(0,s.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s.Lk)("span",{class:"navbar-toggler-icon"})],-1),d={class:"collapse navbar-collapse",id:"navbarNav"},u={class:"d-flex align-items-center ms-auto"},p={class:"input-group mx-3"},m=(0,s.Lk)("i",{class:"fa-solid fa-cart-shopping fs-6"},null,-1),h={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},b=(0,s.Lk)("span",{class:"visually-hidden"},"items in cart",-1),v={key:0,class:"container my-5"},f=(0,s.Lk)("h2",{class:"mb-4"},"Lessons",-1),k={class:"row align-items-center mb-4"},g={class:"col-md-3 mb-2 mb-md-0"},L=(0,s.Lk)("option",{value:"subject"},"Subject",-1),y=(0,s.Lk)("option",{value:"location"},"Location",-1),C=(0,s.Lk)("option",{value:"price"},"Price",-1),w=(0,s.Lk)("option",{value:"availability"},"Availability",-1),x=[L,y,C,w],P={class:"col-md-3 mb-2 mb-md-0"},j=(0,s.Lk)("option",{value:"asc"},"Ascending",-1),O=(0,s.Lk)("option",{value:"desc"},"Descending",-1),F=[j,O],T={class:"col-md-6"},E={class:"input-group"},I={key:1,class:"my-5"},A={key:2,class:"cart mt-5"};function q(e,t,o,L,y,C){const w=(0,s.g2)("LessonComponent"),j=(0,s.g2)("CheckoutForm");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("header",null,[(0,s.Lk)("nav",n,[(0,s.Lk)("div",l,[(0,s.Lk)("a",{class:"navbar-brand",href:"#",textContent:(0,a.v_)(y.sitename)},null,8,i),c,(0,s.Lk)("div",d,[(0,s.Lk)("div",u,[(0,s.Lk)("div",p,[(0,s.bo)((0,s.Lk)("input",{type:"text",onKeyup:t[0]||(t[0]=e=>C.Searching()),"onUpdate:modelValue":t[1]||(t[1]=e=>y.search=e),placeholder:"Search Lesson",id:"search-input",class:"form-control form-control-sm","aria-describedby":"searchButton"},null,544),[[r.Jo,y.search]])]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>C.toggleCheckout()),type:"button",class:"btn btn-primary position-relative"},[m,(0,s.Lk)("span",h,[(0,s.eW)((0,a.v_)(y.cart.length)+" ",1),b])])])])])])]),y.showProduct?((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",null,[f,(0,s.Lk)("div",k,[(0,s.Lk)("div",g,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>y.sortBy=e),class:"form-select form-select-sm"},x,512),[[r.u1,y.sortBy]])]),(0,s.Lk)("div",P,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>y.sortOrder=e),class:"form-select form-select-sm"},F,512),[[r.u1,y.sortOrder]])]),(0,s.Lk)("div",T,[(0,s.Lk)("div",E,[(0,s.bo)((0,s.Lk)("input",{type:"text",onKeyup:t[5]||(t[5]=e=>C.Searching()),"onUpdate:modelValue":t[6]||(t[6]=e=>y.search=e),placeholder:"Search Lesson",id:"search-input",class:"form-control form-control-sm","aria-describedby":"searchButton"},null,544),[[r.Jo,y.search]])])])])])])):(0,s.Q3)("",!0),y.showProduct?((0,s.uX)(),(0,s.CE)("div",I,[(0,s.bF)(w,{"show-product":y.showProduct,"cart-count":C.cartCount,lessons:C.filteredLessons,"can-add-to-cart":C.canAddToCart,onAddToCart:C.addToCart},null,8,["show-product","cart-count","lessons","can-add-to-cart","onAddToCart"])])):((0,s.uX)(),(0,s.CE)("div",A,[(0,s.bF)(j,{"cart-count":C.cartCount,"save-order":C.saveOrder,onRemoveItemFromCart:C.removeFromCart,cart:y.cart,"showhome-page-btn":C.showhomePageBtn},null,8,["cart-count","save-order","onRemoveItemFromCart","cart","showhome-page-btn"])]))])}o(4114);const U=e=>((0,s.Qi)("data-v-50de24eb"),e=e(),(0,s.jt)(),e),_={class:"container"},S={key:0},N={class:"card shadow-sm"},X={class:"card-body"},B={class:"d-flex justify-content-between align-items-center"},V={class:"d-flex flex-row align-items-center"},$=["src"],D={class:"ms-3"},J={class:"mb-0"},K={class:"ms-3"},Q={class:"d-flex flex-row align-items-center"},R={class:"me-3",style:{width:"50px"}},W={class:"fw-normal mb-0"},M={class:"me-3",style:{width:"80px"}},G={class:"mb-0"},Y=["onClick"],z={class:"d-flex justify-content-between text-black h4 mb-4"},H=U((()=>(0,s.Lk)("p",{class:"mb-2"},"Total:",-1))),Z={class:"mb-2"},ee={class:"col-lg-12"},te={class:"text-white rounded-3"},oe={class:"card-body"},re=U((()=>(0,s.Lk)("div",{class:"d-flex justify-content-between align-items-center text-black"},[(0,s.Lk)("h5",{class:"mb-0"},"User details")],-1))),se={key:0,class:"text-danger"},ae={class:"mt-2"},ne={class:"row"},le={class:"col-12 col-md-6 mb-4"},ie=U((()=>(0,s.Lk)("label",{class:"form-label text-black",for:"nameInput"},"Name",-1))),ce=U((()=>(0,s.Lk)("span",{id:"nameMsg",class:"text-danger"},null,-1))),de={class:"col-12 col-md-6 mb-4"},ue=U((()=>(0,s.Lk)("label",{class:"form-label text-black",for:"phoneInput"},"Phone Number",-1))),pe=U((()=>(0,s.Lk)("span",{id:"phoneMsg",class:"text-danger"},null,-1))),me={class:"d-grid gap-2"},he=["disabled"],be={key:1},ve=U((()=>(0,s.Lk)("p",null,"Your cart is empty.",-1))),fe=[ve],ke={class:"modal fade",id:"placeordermodal",tabindex:"-1","aria-labelledby":"placeordermodalLabel","aria-hidden":"true"},ge={class:"modal-dialog"},Le={class:"modal-content"},ye=U((()=>(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"placeordermodalLabel"},"Order Confirmation"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Ce=U((()=>(0,s.Lk)("div",{class:"modal-body"},"Order Confirmed",-1))),we={class:"modal-footer"};function xe(e,t,o,n,l,i){return(0,s.uX)(),(0,s.CE)("section",null,[(0,s.Lk)("div",_,[o.cart.length?((0,s.uX)(),(0,s.CE)("div",S,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.groupedCart,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"mb-4"},[(0,s.Lk)("div",N,[(0,s.Lk)("div",X,[(0,s.Lk)("div",B,[(0,s.Lk)("div",V,[(0,s.Lk)("img",{src:i.ServerImage(e.picture),class:"img-fluid rounded-3",alt:"Shopping item",style:{width:"65px",height:"65px","object-fit":"cover"}},null,8,$),(0,s.Lk)("div",D,[(0,s.Lk)("h5",J,(0,a.v_)(e.subject),1)]),(0,s.Lk)("div",K,[(0,s.Lk)("h5",null,(0,a.v_)(e.quantity),1)])]),(0,s.Lk)("div",Q,[(0,s.Lk)("div",R,[(0,s.Lk)("h5",W,(0,a.v_)(i.CartCount(e)),1)]),(0,s.Lk)("div",M,[(0,s.Lk)("h5",G,(0,a.v_)(i.itemTotalPrice(e))+" AED",1)]),(0,s.Lk)("button",{class:"btn btn-danger",onClick:t=>i.removeFromCart(e.id)}," Remove ",8,Y)])])])])])))),128)),(0,s.Lk)("div",z,[H,(0,s.Lk)("p",Z,"AED "+(0,a.v_)(i.cartTotal),1)]),(0,s.Lk)("div",ee,[(0,s.Lk)("div",te,[(0,s.Lk)("div",oe,[re,l.isFormValid?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("p",se,"Please fill in all fields.")),(0,s.Lk)("form",ae,[(0,s.Lk)("div",ne,[(0,s.Lk)("div",le,[ie,(0,s.bo)((0,s.Lk)("input",{type:"text",id:"nameInput",class:"form-control",placeholder:"Name","onUpdate:modelValue":t[0]||(t[0]=e=>l.order.firstName=e),required:""},null,512),[[r.Jo,l.order.firstName,void 0,{trim:!0}]]),ce]),(0,s.Lk)("div",de,[ue,(0,s.bo)((0,s.Lk)("input",{type:"number",id:"phoneInput",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>l.order.phone=e),required:"",placeholder:"Phone Number"},null,512),[[r.Jo,l.order.phone,void 0,{number:!0}]]),pe])])]),(0,s.Lk)("div",me,[(0,s.Lk)("button",{disabled:!l.isFormValid,type:"button","data-bs-toggle":"modal","data-bs-target":"#placeordermodal",class:"btn btn-primary btn-block",onClick:t[2]||(t[2]=(...t)=>e.ProcessOrder&&e.ProcessOrder(...t))}," CheckOut ",8,he)])])])])])):((0,s.uX)(),(0,s.CE)("div",be,fe)),(0,s.Lk)("div",ke,[(0,s.Lk)("div",ge,[(0,s.Lk)("div",Le,[ye,Ce,(0,s.Lk)("div",we,[(0,s.Lk)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[3]||(t[3]=(...e)=>o.showhomePageBtn&&o.showhomePageBtn(...e))}," Close ")])])])])])])}var Pe={name:"CheckoutForm",props:{cart:{type:Array,required:!0},saveOrder:{type:Function,required:!0},showhomePageBtn:{type:Function,required:!0}},data(){return{order:{firstName:"",phone:""},isFormValid:!1}},watch:{order:{handler(){this.validateForm()},deep:!0}},computed:{groupedCart(){let e={};return this.cart.forEach((t=>{e[t.id]||(e[t.id]={...t,quantity:0}),e[t.id].quantity+=1})),console.log("ðŸš€ ~this.cart:",Object.values(e)),Object.values(e)},cartTotal(){return this.groupedCart.reduce(((e,t)=>e+t.price*t.quantity),0).toFixed(2)},CartItemCount(){return this.cart.length}},methods:{ServerImage(e){const t="https://coursework-2-after-school.onrender.com",o=e.split("/").pop().trim(),r=t+"/"+o;return r},validateForm(){this.isFormValid=!!this.order.firstName&&!!this.order.phone},submitOrder(){this.isFormValid&&(this.order.lessonItems=this.groupedCart.map((e=>({id:e._id,quantity:e.quantity}))),this.saveOrder(this.order))},CartCount(e){this.$emit("cart-count",e)},removeFromCart(e){this.$emit("remove-item-from-cart",e)},itemTotalPrice(e){return(e.price*e.quantity).toFixed(2)},getImageUrl(e){return e.picture||"path/to/your/fallback/image.png"}}},je=o(1241);const Oe=(0,je.A)(Pe,[["render",xe],["__scopeId","data-v-50de24eb"]]);var Fe=Oe;const Te={key:0,class:"container"},Ee={class:"row justify-content-evenly"},Ie={class:"card shadow-sm h-100"},Ae=["src"],qe={class:"card-body d-flex flex-column"},Ue={class:"card-title"},_e={class:"card-text text-muted"},Se={class:"mt-auto"},Ne={class:"mb-1"},Xe=(0,s.Lk)("strong",null,"Location:",-1),Be={class:"mb-1"},Ve=(0,s.Lk)("strong",null,"Available Inventory:",-1),$e={class:"mb-1"},De=(0,s.Lk)("strong",null,"Price:",-1),Je=["onClick"],Ke=(0,s.Lk)("div",null,null,-1);function Qe(e,t,o,r,n,l){return(0,s.uX)(),(0,s.CE)(s.FK,null,[o.lessons.length?((0,s.uX)(),(0,s.CE)("div",Te,[(0,s.Lk)("div",Ee,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.lessons,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"my-3 col-sm-6 col-lg-4"},[(0,s.Lk)("div",Ie,[(0,s.Lk)("img",{src:l.ServerImage(e.picture),class:"card-img-top",alt:"Lesson Image",style:{height:"200px","object-fit":"cover"}},null,8,Ae),(0,s.Lk)("div",qe,[(0,s.Lk)("h5",Ue,(0,a.v_)(e.subject),1),(0,s.Lk)("p",_e,(0,a.v_)(e.description),1),(0,s.Lk)("div",Se,[(0,s.Lk)("p",Ne,[Xe,(0,s.eW)(" "+(0,a.v_)(e.location),1)]),(0,s.Lk)("p",Be,[Ve,(0,s.eW)(" "+(0,a.v_)(e.availability),1)]),(0,s.Lk)("p",$e,[De,(0,s.eW)(" "+(0,a.v_)(e.price)+" AED",1)]),o.canAddToCart(e)?((0,s.uX)(),(0,s.CE)("a",{key:0,onClick:t=>l.addToCart(e),href:"#",class:"btn btn-primary mt-3 w-100"}," ADD TO CART ",8,Je)):(0,s.Q3)("",!0)])])])])))),128))])])):(0,s.Q3)("",!0),Ke],64)}var Re={name:"LessonComponent",props:{lessons:{type:Array,required:!0},canAddToCart:{type:Function,required:!0},cartCount:{type:Function,required:!0},showProduct:{type:Boolean,required:!0}},data(){return{}},computed:{},methods:{addToCart(e){this.$emit("add-to-cart",e)},ServerImage(e){const t="https://coursework-2.onrender.com",o=e.split("/").pop().trim(),r=t+"/"+o;return r}}};const We=(0,je.A)(Re,[["render",Qe]]);var Me=We,Ge={name:"App",components:{CheckoutForm:Fe,LessonComponent:Me},data(){return{sitename:"After School Activities",products:[],cart:[],search:"",showProduct:!0,sortBy:"subject",sortOrder:"asc",ascendingOrder:!0,baseUrl:"https://coursework-2.onrender.com",showInstallPrompt:!1,deferredPrompt:null}},created(){this.fetchLessons(),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.deferredPrompt=e,this.showInstallPrompt=!0}))},methods:{fetchLessons(){fetch(`${this.baseUrl}/collection/products`).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)}))},saveOrder(e){console.log(e),fetch(`${this.baseUrl}/collection/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log("ðŸš€ ~ ProcessOrder ~ resjson:",e)})),console.log(e["lessonItems"]),e["lessonItems"].forEach((e=>{this.UpdateProduct(e.id,e.quantity)})),this.cart=[],this.name="",this.phone=""},UpdateProduct(e,t){fetch(`${this.baseUrl}/collection/products/${e}/reduce/availableSpace/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",mode:"no-cors"}}).then((e=>e.json())).then((e=>console.log("ðŸš€ ~ UpdateProduct ~ resjson:",e)))},addToCart(e){if(this.canAddToCart(e)){const t=this.products.findIndex((t=>t.id===e.id));-1!==t&&(this.products[t].availability--,this.cart.push({...e}))}},canAddToCart(e){return e.availability>this.cartCount(e.id)&&e.availability>0},cartCount(e){let t=this.cart.find((t=>t.id===e.id));return t?t.quantity:0},toggleCheckout(){this.showProduct=!this.showProduct},removeFromCart(e){const t=this.cart.findIndex((t=>t.id===e));if(-1!==t){const o=this.products.findIndex((t=>t.id===e));-1!==o&&this.products[o].availability++,this.cart.splice(t,1)}},promptInstall(){this.deferredPrompt&&(this.deferredPrompt.prompt(),this.deferredPrompt.userChoice.then((e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),this.deferredPrompt=null,this.showInstallPrompt=!1})))},Searching(){let e=this.search.toLowerCase();fetch(`${this.baseUrl}/collection/products/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)}))},showhomePageBtn:function(){try{fetch(`${this.baseUrl}/collection/products`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this.products=e})).catch((e=>{console.error("Error fetching lessons:",e)})),this.toggleCheckout()}catch(e){console.error("ðŸš€ ~ ex:",e)}}},computed:{filteredLessons(){let e=[...this.products];return e.sort(((e,t)=>{let o=0;switch(this.sortBy){case"subject":o=e.subject.localeCompare(t.subject);break;case"location":o=e.location.localeCompare(t.location);break;case"price":o=e.price-t.price;break;case"availability":o=e.availability-t.availability;break}return"asc"===this.sortOrder?o:-o}))}}};const Ye=(0,je.A)(Ge,[["render",q]]);var ze=Ye,He=o(4458);(0,He.k)("service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,r.Ef)(ze).mount("#app")}},t={};function o(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,r,s,a){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],s=e[d][1],a=e[d][2];for(var l=!0,i=0;i<r.length;i++)(!1&a||n>=a)&&Object.keys(o.O).every((function(e){return o.O[e](r[i])}))?r.splice(i--,1):(l=!1,a<n&&(n=a));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[r,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,a,n=r[0],l=r[1],i=r[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in l)o.o(l,s)&&(o.m[s]=l[s]);if(i)var d=i(o)}for(t&&t(r);c<n.length;c++)a=n[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},r=self["webpackChunkcoursework_app"]=self["webpackChunkcoursework_app"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(3515)}));r=o.O(r)})();
//# sourceMappingURL=app.56d1c418.js.map